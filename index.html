<!DOCTYPE html>
<meta charset="utf-8">


<html>


<!--Source Codes-->
<script  src = "C:\Users\sarah\OneDrive\01_2024 Works\01_SUTD\TRIMESTER II\Interactive Data Visulisation\ASSIGNMENT 5 - FINAL\config.js" ></script>


<!-- Installs -->
    <!--GEE - Google Earth Engine 
    <script>
    //require('dotenv').config();

    //GEE (Google Earth Engine)

    //const apiKeyGEE = process.env.API_KEY-GEE; // Refers to Location of API Key 
        const apiKeyGEE = config.API_KEYGEE;
            //const ee = require('@google/earthengine');
        </script> 
    -->

    <!-- Vue.js: Nuxt-UU -->
    <script>
        //main.js - adding @nuxt/ui-pro as a depedency to projecy
        import { NuxtUU } from '@nuxt/ui-pro';
        Vue.use(NuxtUU);

        //nuxt.config.js
        export default defineNuxtConfig({
            extends: ['@nuxt/ui-pro'],
            modules: ['@nuxt/ui']
        })
    </script>



<!-- Libaries Loaded -->
    <!-- D3 -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script> 
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>

    <!-- W3 -->
    <script src="https://www.w3schools.com/lib/w3.js"></script>

    <!-- GEE -->
    <script src="C:\Users\sarah\node_modules\@google\earthengine\src"></script>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- API's Integrated -->

    <!-- GEE (Google Earth Engine) 
    <script>
        // Integration after Library Loaded
        ee.data.authenticateViaApiKey(apiKeyGEE, () => {
          console.log('Authentication successful');
          ee.initialize(null, null, () => {
            console.log('Earth Engine client initialized');
            // Earth Engine API is now active
          }, (err) => {
            console.error('GEE Initialization error: ' + err);
          });
        }, (err) => {
          console.error('GEE Authentication error: ' + err);
        });
      </script>
      -->
 



<!-- CSS Style -->
    <style>

    .tooltip {
        position: absolute;
        background-color: #fff;
        padding: 10px;
        border: 1px solid #046468;
        border-radius: 5px;
        pointer-events: none;
        opacity: 0;
        }

        body {
            font-family: "Roboto", helvetica, arial, sans-serif;
            display: block;
            margin: auto;
            width: 100%;
            text-align: center;
            font-size: 20px;
        }
        h1 {
        margin: 0px;
        font-size: 30px;
        font-weight: 400;
        font-style:normal;
        color: #fff;
        text-transform:uppercase;
        }
        h2 {
        margin: 2px;
        font-size: 20px;
        font-weight: 400;
        font-style:normal;
        color: #fff;
        text-transform:uppercase;
        }
    
            @keyframes scroll {
                0% { transform: translateX(100%); }
                100% { transform: translateX(-100%); }
        }

            .scrolling-text {
                position: relative;
                font-family: "Roboto", helvetica, sans-serif;
                font-size: 20px;
                white-space: nowrap;
                overflow: hidden;
                display: block;
                color: #fff;
        }

            .scrolling-text p {
                display: inline-block;
                padding-left: 5%; /* Initial offset */
                animation: scroll 50s linear infinite; /* Adjust the timing to control the speed */
        }

        a {
        color: black;
    }

        body {
        margin: 50;
        }

        .vue-button-01 {
        background-color: green;
        color: white;
        border: none;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
    }




    </style>

<!-- Background Style -->
    <body style="background-color: #081129;">

<!-- Containers: where the maps and Graphs will take place
-->
    
    <div id="Mp1_Atlas" style="width: 100%; height: 800px;" class="w3-center"></div>
    <div id="Video" width="500" height="300"></div>
    <div id="Graphs" width="500" height="300"></div>

    
    <!--
    <svg id="Mp1_Atlas"></svg>
    <div id="Graphs" width="500" height="300"></div>
    <div id="Mp2_Coast" width="500" height="300"></div>
    -->

<!--Define Tooltip -->
    <div class="tooltip"></div>


<body>

    <!--Vue.js: Nuxt-U - Button -->
    <template>
    <UButton color="white" variant="ghost">Button</UButton>
    </template>
    
    <!--JS Script-->
    <script>
    // -------------------------------------- Div 1:: id: Mp1_Atlas----------------------------------------------

    //dimensions
    let width = 1000, height = 600;

    let svgAtlas = d3.select("#Mp1_Atlas")
        .attr("viewBox", "0 0 " + width+ " " + height)
        .attr("width", 1400)
        .attr("height", 900)
        

    // Map and projection
    let projection = d3.geoMercator()
        //d3.geoEquirectangular()
            //.center([1.357868, 103.810847]) //Center to Singapore
            .center([10, 113], 4.5) // Rough central point for Southeast Asia
            .scale(700)
            .translate([(width/2)-150, (height/2)+125])

    let geopath = d3.geoPath().projection(projection);


    //Create the map with leaflet
    //var map = L.map('Mp1_Atlas').setView([1.357868, 103.810847], 13); //centered on Singapore
    //var map = L.map('Mp1_Atlas').setView([1, 113], 5); //rough central point for Southeast Asia

    // Create the map zoom bounds
    var map = L.map('Mp1_Atlas', {
        minZoom: 4.5,
        maxZoom: 4.5,	
        //maxBounds: [[-90, -180], [90, 180]], // This line restricts the view to the whole world
        maxBounds: [[20, 80], [0, 150]], // This line restricts the view just around Southeast Asia
        maxBoundsViscosity: 1.0, //adds that lil bounce back effect
    }).setView([10, 113], 4.5);

    // Add a tile layer to the map (this is the actual map imagery)
    //L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {

        //charcaol themed map
        // Add a dark tile layer to the map
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '© OpenStreetMap contributors, © CARTO',
            maxZoom: 19,
        }).addTo(map);
 
    /* 
    // Load the CSV data
     d3.csv('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/global%20tree%20watch/Global%20annual%20tree%20cover%20loss%20by%20dominant%20driver/treecover_extent_2000__ha.csv').then((csvData) => {
        // Convert the CSV data to a map for easier lookup
        const countryData = new Map(csvData.map(row => [row.COUNTRY, row]));
        */

        // Load the GeoJSON data
        fetch('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/world_forest.geojson')
            .then(response => response.json())
       
            .then(MapData => {
                          

            // Filter to include only Southeast Asian countries
            //data.features = data.features.filter(function(d) {console.log(d.properties.name);
            MapData.features = MapData.features.filter(function(d) {   
                return ["Indonesia", "Malaysia", "Philippines", "Singapore", "Thailand", 
                        "Brunei", "Vietnam", "Laos", "Myanmar", "Cambodia"]
                    .includes(d.properties.name);

            });
                
                // Add the GeoJSON layer to the map
                L.geoJSON(MapData, {
                    onEachFeature: function (feature, layer) {
                        console.log(feature.properties);
                        
                        // Get the data for this country
                        //const country = MapData.get(feature.properties.name);
                        const country = feature.properties;

                        // Calculate the percentage of the country covered by trees
                        const treeCoverPercentage = Math.round((country.gwf_umd_tree_cover_extent_2000__ha / country.gwf_area__ha) * 100);

                        // Format the values
                        //in ha (hectars)
                        //const treeCover = Math.round(country.gwf_umd_tree_cover_extent_2000__ha).toLocaleString();
                        //const area = Math.round(country.gwf_area__ha).toLocaleString();
                        //in Mha (million hectars)

                        // Format the values
                        // Convert the values to million hectares (Mha)
                        const treeCoverMha = (country.gwf_umd_tree_cover_extent_2000__ha / 1000000).toFixed(0);
                        const areaMha = (country.gwf_area__ha / 1000000).toFixed(0);



                        // Bind a popup to each feature
                        layer.bindPopup(`
                           This is <strong>${country.name}</strong> <br><br>
                            <em>Looking back at 2020:</em><br>
                            Total Country Area Size was <strong>${areaMha} Mha</strong><br>
                            of which<strong> ${treeCoverPercentage}%</strong> had forest coverage`);
                            
                    }
                }).addTo(map);
            });

    





    /* Create the map with leaflet
    //var map = L.map('Mp1_Atlas').setView([1.357868, 103.810847], 13);
    var map = L.map('Mp1_Atlas').setView([0,0], 1);

    // Add a tile layer to the map (this is the actual map imagery)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
    }).addTo(map);

    // Load the CSV data
    d3.csv('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/global%20tree%20watch/Global%20annual%20tree%20cover%20loss%20by%20dominant%20driver/treecover_extent_2000__ha.csv').then((csvData) => {
        // Convert the CSV data to a map for easier lookup
        const countryData = new Map(csvData.map(row => [row.COUNTRY, row]));

        // Load the GeoJSON data
        fetch('https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson')
            .then(response => response.json())
       

            .then(data => {
                console.log(data);
                
                // Add the GeoJSON layer to the map
                L.geoJSON(data, {
                    onEachFeature: function (feature, layer) {
                        // Get the data for this country
                        const country = countryData.get(feature.properties.COUNTRY);

                        // Bind a popup to each feature
                        layer.bindPopup(`
                            <strong>Country:</strong> ${country.COUNTRY}<br>
                            <strong>Total Tree Cover:</strong> ${country.gtw_treeCover_yr200_ha} ha<br>
                            <strong>Total Country Area:</strong> ${country.gtw_area_yr2000_ha} ha
                        `);
                    }
                }).addTo(map);
            });
    });
    */
    /* Load the GeoJSON data

    //load the GeoJson and set teh code to no-cors to bypass CORS Policy 
    fetch("https://github.com/sarahtuke/HASS-assignment-5.2/raw/main/data%20src/sea_geo/sea_simp02.geojson", { mode: 'no-cors' })
        .then(response => response.json())
        .then(geojsonData => {
            
            d3.json("https://github.com/sarahtuke/HASS-assignment-5.2/raw/main/data%20src/sea_geo/sea_simp02.geojson").then((geojsonData) => {
        // Create an object to store the aggregated data for each country
        const countryData = {};

    // Iterate through each feature in the GeoJSON data
    geojsonData.features.forEach((feature) => {
        const country = feature.properties.COUNTRY; // Get the country name
        const treeCover = parseFloat(feature.properties.gtw_treeCover_yr200_ha); // Get the tree cover extent
        const countryArea = parseFloat(feature.properties.gtw_area_yr2000_ha); // Get the country area

        // If the country is already in the countryData object, add to its existing values
        if (countryData[country]) {
            countryData[country].treeCover += treeCover;
            countryData[country].countryArea += countryArea;
        } else {
            // Otherwise, create a new entry for the country
            countryData[country] = {
                treeCover: treeCover,
                 countryArea: countryArea
            };
        }
    });

        })
        .catch(error => {
            console.error("Error loading GeoJSON:", error);
        });





    // Append the GeoJSON features to the SVG
    svg.selectAll("path")
        .data(geojsonData.features)
        .enter()
        .append("path")
        .attr("d", path) // Set the path data
        .style("fill", "lightgray") // Set the fill color for countries
        .style("stroke", "black") // Set the stroke for country borders
        .on("mouseover", function(event, d) {
            const country = d.properties.COUNTRY;
            const treeCover = countryData[country].treeCover;
            const countryArea = countryData[country].countryArea;

            // Create a tooltip
            const tooltip = d3.select("body").append("div")
                .attr("class", "tooltip")
                .style("position", "absolute")
                .style("background", "white")
                .style("border", "1px solid black")
                .style("padding", "5px")
                .style("visibility", "hidden");

            tooltip.html(
                `<strong>Country:</strong> ${country}<br>` +
                `<strong>Total Tree Cover:</strong> ${treeCover.toFixed(2)} ha<br>` +
                `<strong>Total Country Area:</strong> ${countryArea.toFixed(2)} ha`
            );

            tooltip.style("visibility", "visible");
        })
        .on("mousemove", function(event) {
            // Update tooltip position
            d3.select(".tooltip").style("top", (event.pageY + 10) + "px")
                .style("left", (event.pageX + 10) + "px");
        })
        .on("mouseout", function() {
            // Hide and remove the tooltip
            d3.select(".tooltip").style("visibility", "hidden").remove();
        });
});

*/

    /*d3.json("https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/world_forest.geojson").then(data => {

        // Filter to include only Southeast Asian countries
        //data.features = data.features.filter(function(d) {console.log(d.properties.name);
        data.features = data.features.filter(function(d) {   
            return ["Indonesia", "Malaysia", "Philippines", "Singapore", "Thailand", 
                    "Brunei", "Vietnam", "Laos", "Myanmar", "Cambodia"]
                    .includes(d.properties.name);
        
        });
   
                    
        // Draw the map
        svgAtlas.append("g")
            .attr("id", "countries")
            .selectAll("path")
            .data(data.features)
            .enter()
            .append("path")
                .attr("d",  d => geopath(d))
                .attr("fill", "#777")
                .attr("stroke", "#fff")
                .attr("stroke-width", 0.5)
                

    //ToolTip 
    // Define the div for the tooltip

        // Event handlers: update tooltip relative to mouse pointer
        //turning on the mouuse-over fucntion
        .on("mouseover", (event, d) => {
            const centroid = geopath.centroid(d);
            const [x, y] = centroid;
            

        d3.select(event.currentTarget)
        .classed("highlighted", true)
        //.attr("transform",`translate(${x * (1 - scale)}, ${y * (1- scale)}) scale(${scale}, ${scale})`)
        .raise(); // Raise section above projection


        //making the mouse-over function link to the tooltip
               let tooltip_Mp1_Atlas = d3.select(".tooltip");
        tooltip_Mp1_Atlas.style("opacity", 1)
            .html(`<strong>${d.properties.name}</strong>`)
            .style("display", "block")
            .style("left", event.pageX + 60 + "px")
            .style("top", event.pageY - 60 + "px");
            })
            .on("mouseout", (event, d) => {
                d3.select(event.currentTarget)
                .classed("highlighted", false)
                .attr("transform", "translate(0, 0) scale(1, 1)");

                d3.select(".tooltip").style("display", "none");
            });


        
    // Filter to include all countries
        data.all = data.features.filter(function(d) {console.log(d.properties.name); 
            return includes(d.properties.name);
                    
        });

        // Draw the map
        svgAtlas.append("g")
            .attr("id", "countries")
            .selectAll("path")
            .data(data.all)
            .enter()
            .append("path")
                .attr("d",  d => geopath(d))
                .attr("fill", "#777")
                .attr("stroke", "#fff")
                .attr("stroke-width", 0.5)
    
            //end of data access
            })
        */  

        //end of script
        </script>

    <!-- <h2 class="w3-center">--&nbsp;*&nbsp;--</h2> -->
        <!-------------------------------------------Div 2:: id: Video------------------------------------------------> 

    <h2 class="w3-center">--&nbsp;*&nbsp;--</h2>

   <script>
    //dimensions
        let d2_width = 1000, d2_height = 600;
    
    // Video
        let video = d3.select("#Video")
            .append("video")
            .attr("width", 500)
            .attr("height", 300)
            .attr("controls", true)
            .attr("autoplay", true)
            .append("source")
            .attr("src", "https://www.youtube.com/watch?v=Brmfwu2e7OI&ab_channel=TheTravelIntern")
            .attr("type", "video/mp4")

    //Enter button to play video - Vue Button
        // Vue instance
        //vue-button-01
        // Vue instance
        new Vue({
            el: '#Video',
            components: {
                'u-button': UButton
                }
                });


         <div id="Video">
            <u-button color="green" variant="ghost">Button</u-button>
            </div>

    </script>

        <!-------------------------------------------Div 3:: id: Graphs-------------------------------------------------> 

   <!-- <svg width="1000" height="2000" xmlns="http://www.w3.org/2000/svg"  class="w3-center">      </svg> -->
        <rect width="900" height="3200" x="10" y="10" rx="20" ry="20" fill="#354b79" class="w3-center"/>

            <div class="w3-center" style="position: relative;">
               <!--
                <img src="Image Examples_Graphs .png" alt="LA" style="width:50%; opacity: 0.8;">
               -->
            
            </div>
   

    <h2 class="w3-center">--&nbsp;*&nbsp;--</h2>

        <!-------------------------------------------Div 4:: id: Mp2_Coast-----------------------------------------------> 
           
        <div class="w3-center" style="position: relative;">
                <!--
                    <img src="Image Examples_SVG Maps .png" alt="LA" style="width: 50%; opacity: 0.8;">
                -->
            
            </div>
        
    
        




</body>
</html>


