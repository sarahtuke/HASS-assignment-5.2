<!DOCTYPE html>
<meta charset="utf-8">


<html>


<!--Source Codes-->
<script  src = "C:\Users\sarah\OneDrive\01_2024 Works\01_SUTD\TRIMESTER II\Interactive Data Visulisation\ASSIGNMENT 5 - FINAL\config.js" ></script>


<!-- Installs -->
    <!--GEE - Google Earth Engine 
    <script>
    //require('dotenv').config();

    //GEE (Google Earth Engine)

    //const apiKeyGEE = process.env.API_KEY-GEE; // Refers to Location of API Key 
        const apiKeyGEE = config.API_KEYGEE;
            //const ee = require('@google/earthengine');
        </script> 
    -->

    <!-- Vue.js: Nuxt-UU -->
    <script>
        //main.js - adding @nuxt/ui-pro as a depedency to projecy
        import { NuxtUU } from '@nuxt/ui-pro';
        Vue.use(NuxtUU);

        //nuxt.config.js
        export default defineNuxtConfig({
            extends: ['@nuxt/ui-pro'],
            modules: ['@nuxt/ui']
        })
    </script>



<!-- Libaries Loaded -->
    <!-- D3 -->

    <!-- 
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script> 
    -->

    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>

    
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://unpkg.com/d3-simple-slider"></script>


        <!-- D3 Slider -->
        <script> src="/d3.min.js"</script>
        <script src="https://d3-simple-slider.js"></script>
  

    <!-- W3 -->
    <script src="https://www.w3schools.com/lib/w3.js"></script>

    <!-- GEE -->
    <script src="C:\Users\sarah\node_modules\@google\earthengine\src"></script>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- API's Integrated -->

    <!-- GEE (Google Earth Engine) 
    <script>
        // Integration after Library Loaded
        ee.data.authenticateViaApiKey(apiKeyGEE, () => {
          console.log('Authentication successful');
          ee.initialize(null, null, () => {
            console.log('Earth Engine client initialized');
            // Earth Engine API is now active
          }, (err) => {
            console.error('GEE Initialization error: ' + err);
          });
        }, (err) => {
          console.error('GEE Authentication error: ' + err);
        });
      </script>
      -->
 



<!-- CSS Style -->
    <style>

    .tooltip {
        position: absolute;
        background-color: #fff;
        padding: 10px;
        border: 1px solid #046468;
        border-radius: 5px;
        pointer-events: none;
        opacity: 0;
        }

        body {
            font-family: "Roboto", helvetica, arial, sans-serif;
            display: block;
            margin: auto;
            width: 100%;
            text-align: center;
            font-size: 20px;
        }
        h1 {
        margin: 0px;
        font-size: 30px;
        font-weight: 400;
        font-style:normal;
        color: #fff;
        text-transform:uppercase;
        }
        h2 {
        margin: 2px;
        font-size: 20px;
        font-weight: 400;
        font-style:normal;
        color: #fff;
        text-transform:uppercase;
        }
    
            @keyframes scroll {
                0% { transform: translateX(100%); }
                100% { transform: translateX(-100%); }
        }

            .scrolling-text {
                position: relative;
                font-family: "Roboto", helvetica, sans-serif;
                font-size: 20px;
                white-space: nowrap;
                overflow: hidden;
                display: block;
                color: #fff;
        }

            .scrolling-text p {
                display: inline-block;
                padding-left: 5%; /* Initial offset */
                animation: scroll 50s linear infinite; /* Adjust the timing to control the speed */
        }

        a {
        color: black;
        }

        #body_txt {/* or #ctch_text if it's an id */
        margin: 10px;
        font-family: poppins;
        background-color: #081129;
        color: white;
        font-size: 15px;
        }

        
        #catch_txt {/* or #ctch_text if it's an id */
        margin: 20px;
        font-family: poppins;
        color: #0b3f1e;
        font-size: 30px;
        }

        .vue-button-01 {
        background-color: green;
        color: white;
        border: none;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;


    }

    #container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-gap: 10px;
}

#map {
            
            position: relative; /* Important for absolute positioning of child elements */
        }

        #text-overlay {
            position: absolute; /* Absolute positioning to place it on the map */
            top: 10px; /* Distance from the top */
            right: 10px; /* Distance from the right */
            background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent background */
            color: white; /* Text color */
            padding: 10px; /* Padding around the text */
            font-family: poppins; /* Font family */
            border-radius: 5px; /* Rounded corners */
            
        }




    </style>

<!-- Background Style -->
    <body style="background-color: #081129;">

<!-- Containers: where the maps and Graphs will take place
-->
    
    <div id="Mp1_Atlas" style="width: 100%; height: 800px;" class="w3-center" position = "absolute"></div>
    <div style="clear:both;"></div>
    <div id="Dv2_TropicalForests" style="height: 800px; position: absolute; margin:auto"></div>
   
    <!--
    <div id="Dv2_TropicalForests" width="80%" height="1000" position = "absolute" ></div>

    <svg id="Mp1_Atlas"></svg>
    <div id="Video" width="500" height="300"></div>
    <div id="Graphs" width="500" height="300"></div>
    <div id="Mp2_Coast" width="500" height="300"></div>
    -->

<!--Define Tooltip -->
    <div class="tooltip"></div>



    <!--Vue.js: Nuxt-U - Button -->
    <template>
    <UButton color="white" variant="ghost">Button</UButton>
    </template>
    
    <body>

          <!-----Welcome Text -->

        <div id="map"></div> <!-- The Leaflet map container -->
        <div id="text-overlay">FORESTS AT SEA</div> <!-- Text overlay -->


        <body>
            <!-- Your HTML code -->
            <div class="scrolling-text">
                
                <p style="color: #7693d1; font-size: 25px;" >Welcome to <b>Forests at SEA!</b>
                    A page navigating through the forests of Southeast Asia to understand the mechanisms of deforestation in this regions Archipelagos.
                <em><b>Click a country for more info</em></b>
            <br>
            </p>
            </div>


            <div class="scrolling-text">
            <p  style="color: #354b79;">Malay Archipelago &nbsp;&nbsp;&nbsp;* &nbsp;&nbsp;&nbsp;Riau Archipelago &nbsp;&nbsp;&nbsp;* &nbsp;&nbsp;&nbsp;Maritime Southeast Asia &nbsp;&nbsp;&nbsp;* &nbsp;&nbsp;&nbsp;Indonesian Archipelago &nbsp;&nbsp;&nbsp;* &nbsp;&nbsp;&nbsp;Nusantara &nbsp;&nbsp;&nbsp;* &nbsp;&nbsp;&nbsp;East Indies &nbsp;&nbsp;&nbsp;* &nbsp;&nbsp;&nbsp;</p>
            </div>
        </body>


            
    <!-----JS Script-->
    <script>

    // -------------------------------------- Div 1:: id: Mp1_Atlas----------------------------------------------

    //dimensions
    let width = 1000, height = 600;

    let svgAtlas = d3.select("#Mp1_Atlas")
        .attr("viewBox", "0 0 " + width+ " " + height)
        .attr("width", 1400)
        .attr("height", 900)
     
        

    // Map and projection
    let projection = d3.geoMercator()
        //d3.geoEquirectangular()
            //.center([1.357868, 103.810847]) //Center to Singapore
            .center([10, 113], 4.5) // Rough central point for Southeast Asia
            .scale(700)
            .translate([(width/2)-150, (height/2)+125])

    let geopath = d3.geoPath().projection(projection);


    //Create the map with leaflet
    //var map = L.map('Mp1_Atlas').setView([1.357868, 103.810847], 13); //centered on Singapore
    //var map = L.map('Mp1_Atlas').setView([1, 113], 5); //rough central point for Southeast Asia

    // Create the map zoom bounds
    var map = L.map('Mp1_Atlas', {
        minZoom: 4.5,
        maxZoom: 4.5,	
        //maxBounds: [[-90, -180], [90, 180]], // This line restricts the view to the whole world
        maxBounds: [[20, 80], [0, 150]], // This line restricts the view just around Southeast Asia
        maxBoundsViscosity: 1.0, //adds that lil bounce back effect
    }).setView([10, 113], 4.5);

    // Add a tile layer to the map (this is the actual map imagery)
    //L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {

        //charcaol themed map
        // Add a dark tile layer to the map
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '© OpenStreetMap contributors, © CARTO',
            maxZoom: 19,
        }).addTo(map);
 
    /* 
    // Load the CSV data
     d3.csv('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/global%20tree%20watch/Global%20annual%20tree%20cover%20loss%20by%20dominant%20driver/treecover_extent_2000__ha.csv').then((csvData) => {
        // Convert the CSV data to a map for easier lookup
        const countryData = new Map(csvData.map(row => [row.COUNTRY, row]));
        */

        // Load the GeoJSON data
fetch('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/world_forest.geojson')
    .then(response => response.json())
    .then( MapData => {
        // Filter to include only Southeast Asian countries
        MapData.features = MapData.features.filter(function(d) {   
            return ["Indonesia", "Malaysia", "Philippines", "Singapore", "Thailand", 
                    "Brunei", "Vietnam", "Laos", "Myanmar", "Cambodia"]
                .includes(d.properties.name);
        });

        // Calculate the tree coverage percentage for each country
        MapData.features.forEach(function(d) {
            d.properties.treeCoverPercentage = Math.round((d.properties.gwf_umd_tree_cover_extent_2000__ha / d.properties.gwf_area__ha) * 100);
        });

        // Create a color scale
        var color = d3.scaleSequential()
            .domain([0, 100])
            .interpolator(d3.interpolateGreens);

        // Add the GeoJSON layer to the map
        L.geoJSON(MapData, {
            style: function(feature) {
                return {fillColor: color(feature.properties.treeCoverPercentage), fillOpacity: 0.5, weight: 0.5, stroke: true, color: 'White'};
            },
            onEachFeature: function (feature, layer) {
                console.log(feature.properties);
                
                // Get the data for this country
                const country = feature.properties;

                // Format the values
                // Convert the values to million hectares (Mha)
                const treeCoverMha = (country.gwf_umd_tree_cover_extent_2000__ha / 1000000).toFixed(0);
                const areaMha = (country.gwf_area__ha / 1000000).toFixed(0);

                // Bind a popup to each feature
                layer.bindPopup(`
                    This is <strong>${country.name}</strong> <br><br>
                    <em>Looking back at 2020:</em><br>
                    Total Country Area Size was <strong>${areaMha} Mha</strong><br>
                    of which<strong> ${feature.properties.treeCoverPercentage}%</strong> had forest coverage`);
            }
        }).addTo(map);

        // Create a legend
        var legend = L.control({position: 'bottomleft'});

        legend.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 20, 40, 60, 80, 100], // These are the breakpoints for the colors in the legend
                labels = ['<strong>Density of Forest Coverage (%)</Strong>'];	// This is the title of the legend

                 // Set the color of the text to white
                div.style.color = '#bebebe';

                // Add the title to the legend
                div.innerHTML = labels[0] + '<br>';
                

            // Loop through our intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                '<i style="background:' + color(grades[i] + 1) + '; width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7;"></i> '
                + grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '%<br>' : '+%');
            }

    return div;
};

// Add the legend to the map
legend.addTo(map);
   

    
        //previous attempts
        /* Create the map with leaflet

        //var map = L.map('Mp1_Atlas').setView([1.357868, 103.810847], 13);
        var map = L.map('Mp1_Atlas').setView([0,0], 1);

        // Add a tile layer to the map (this is the actual map imagery)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);

        // Load the CSV data
        d3.csv('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/global%20tree%20watch/Global%20annual%20tree%20cover%20loss%20by%20dominant%20driver/treecover_extent_2000__ha.csv').then((csvData) => {
            // Convert the CSV data to a map for easier lookup
            const countryData = new Map(csvData.map(row => [row.COUNTRY, row]));

            // Load the GeoJSON data
            fetch('https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson')
                .then(response => response.json())
        

                .then(data => {
                    console.log(data);
                    
                    // Add the GeoJSON layer to the map
                    L.geoJSON(data, {
                        onEachFeature: function (feature, layer) {
                            // Get the data for this country
                            const country = countryData.get(feature.properties.COUNTRY);

                            // Bind a popup to each feature
                            layer.bindPopup(`
                                <strong>Country:</strong> ${country.COUNTRY}<br>
                                <strong>Total Tree Cover:</strong> ${country.gtw_treeCover_yr200_ha} ha<br>
                                <strong>Total Country Area:</strong> ${country.gtw_area_yr2000_ha} ha
                            `);
                        }
                    }).addTo(map);
                });
        });
        */
        
        /* Load the GeoJSON data

        //load the GeoJson and set teh code to no-cors to bypass CORS Policy 
        fetch("https://github.com/sarahtuke/HASS-assignment-5.2/raw/main/data%20src/sea_geo/sea_simp02.geojson", { mode: 'no-cors' })
            .then(response => response.json())
            .then(geojsonData => {
                
                d3.json("https://github.com/sarahtuke/HASS-assignment-5.2/raw/main/data%20src/sea_geo/sea_simp02.geojson").then((geojsonData) => {
            // Create an object to store the aggregated data for each country
            const countryData = {};

        // Iterate through each feature in the GeoJSON data
        geojsonData.features.forEach((feature) => {
            const country = feature.properties.COUNTRY; // Get the country name
            const treeCover = parseFloat(feature.properties.gtw_treeCover_yr200_ha); // Get the tree cover extent
            const countryArea = parseFloat(feature.properties.gtw_area_yr2000_ha); // Get the country area

            // If the country is already in the countryData object, add to its existing values
            if (countryData[country]) {
                countryData[country].treeCover += treeCover;
                countryData[country].countryArea += countryArea;
            } else {
                // Otherwise, create a new entry for the country
                countryData[country] = {
                    treeCover: treeCover,
                    countryArea: countryArea
                };
            }
        });

            })
            .catch(error => {
                console.error("Error loading GeoJSON:", error);
            });





        // Append the GeoJSON features to the SVG
        svg.selectAll("path")
            .data(geojsonData.features)
            .enter()
            .append("path")
            .attr("d", path) // Set the path data
            .style("fill", "lightgray") // Set the fill color for countries
            .style("stroke", "black") // Set the stroke for country borders
            .on("mouseover", function(event, d) {
                const country = d.properties.COUNTRY;
                const treeCover = countryData[country].treeCover;
                const countryArea = countryData[country].countryArea;

                // Create a tooltip
                const tooltip = d3.select("body").append("div")
                    .attr("class", "tooltip")
                    .style("position", "absolute")
                    .style("background", "white")
                    .style("border", "1px solid black")
                    .style("padding", "5px")
                    .style("visibility", "hidden");

                tooltip.html(
                    `<strong>Country:</strong> ${country}<br>` +
                    `<strong>Total Tree Cover:</strong> ${treeCover.toFixed(2)} ha<br>` +
                    `<strong>Total Country Area:</strong> ${countryArea.toFixed(2)} ha`
                );

                tooltip.style("visibility", "visible");
            })
            .on("mousemove", function(event) {
                // Update tooltip position
                d3.select(".tooltip").style("top", (event.pageY + 10) + "px")
                    .style("left", (event.pageX + 10) + "px");
            })
            .on("mouseout", function() {
                // Hide and remove the tooltip
                d3.select(".tooltip").style("visibility", "hidden").remove();
            });
    });

    */

        /*d3.json("https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/world_forest.geojson").then(data => {

            // Filter to include only Southeast Asian countries
            //data.features = data.features.filter(function(d) {console.log(d.properties.name);
            data.features = data.features.filter(function(d) {   
                return ["Indonesia", "Malaysia", "Philippines", "Singapore", "Thailand", 
                        "Brunei", "Vietnam", "Laos", "Myanmar", "Cambodia"]
                        .includes(d.properties.name);
            
            });
    
                        
            // Draw the map
            svgAtlas.append("g")
                .attr("id", "countries")
                .selectAll("path")
                .data(data.features)
                .enter()
                .append("path")
                    .attr("d",  d => geopath(d))
                    .attr("fill", "#777")
                    .attr("stroke", "#fff")
                    .attr("stroke-width", 0.5)
                    

        //ToolTip 
        // Define the div for the tooltip

            // Event handlers: update tooltip relative to mouse pointer
            //turning on the mouuse-over fucntion
            .on("mouseover", (event, d) => {
                const centroid = geopath.centroid(d);
                const [x, y] = centroid;
                

            d3.select(event.currentTarget)
            .classed("highlighted", true)
            //.attr("transform",`translate(${x * (1 - scale)}, ${y * (1- scale)}) scale(${scale}, ${scale})`)
            .raise(); // Raise section above projection


            //making the mouse-over function link to the tooltip
                let tooltip_Mp1_Atlas = d3.select(".tooltip");
            tooltip_Mp1_Atlas.style("opacity", 1)
                .html(`<strong>${d.properties.name}</strong>`)
                .style("display", "block")
                .style("left", event.pageX + 60 + "px")
                .style("top", event.pageY - 60 + "px");
                })
                .on("mouseout", (event, d) => {
                    d3.select(event.currentTarget)
                    .classed("highlighted", false)
                    .attr("transform", "translate(0, 0) scale(1, 1)");

                    d3.select(".tooltip").style("display", "none");
                });


            
        // Filter to include all countries
            data.all = data.features.filter(function(d) {console.log(d.properties.name); 
                return includes(d.properties.name);
                        
            });

            // Draw the map
            svgAtlas.append("g")
                .attr("id", "countries")
                .selectAll("path")
                .data(data.all)
                .enter()
                .append("path")
                    .attr("d",  d => geopath(d))
                    .attr("fill", "#777")
                    .attr("stroke", "#fff")
                    .attr("stroke-width", 0.5)
        
                //end of data access
                })
            */  

    //end of script for Div 1
  

//          -------------------------------------------Dv2_TropicalForests------------------------------------------------

      //  <!-- Calculations -->
     
      // Load the CSV data
    d3.csv('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/global%20tree%20watch/Global%20annual%20tree%20cover%20loss%20by%20dominant%20driver/treecover_loss_in_primary_forests_2001_tropics_only__ha.csv')
    .then(csvData => {

        const seAsiaData = csvData.filter(row => {
            return ['KHM', 'SGP', 'THA', 'MMR', 'LAO', 'VNM', 'IDN', 'MYS', 'PHL', 'TLS'].includes(row.iso);
        });

        // Group the data by year
        const groupedData = seAsiaData.reduce((acc, row) => {
            const year = row.umd_tree_cover_loss__year;
            if (!acc[year]) {
                acc[year] = [];
            }
            acc[year].push(row);
            return acc;
        }, {});

        // Calculate the total tree cover loss for each year
        const totalLossByYear = Object.entries(groupedData).map(([year, data]) => {
    console.log('Before conversion:', data.map(d => d.umd_tree_cover_loss_ha));
    const totalLoss = d3.sum(data, d => {
        const loss = +d.umd_tree_cover_loss_ha;
        //console.log('After conversion:', loss);
        return loss;
    });
    return {
        year: year,
        totalLoss: totalLoss
            };
        });

        //console.log("Tree Loss by Year", totalLossByYear);

    
    /*    // Filter the data to include only Southeast Asian countries
    //const seAsiaData = csvData.filter(row => {
        //return MapData.features.some(feature => feature.properties.Id === row.iso); //OG code
        //return row.iso !== 'SGP' && MapData.features.some(feature => feature.properties.Id === row.iso); //Trying to exclude Singapore
    
    // Define an array of Southeast Asian ISO codes
    const seAsiaISOs = ['KHM', 'SGP', 'THA', 'MMR', 'LAO', 'VNM', 'IDN', 'MYS', 'PHL', 'TLS'];

    // Filter the CSV data to include only the countries with the specified ISO codes
    const seAsiaData = csvData.filter(row => seAsiaISOs.includes(row.iso));
    //console.log(seAsiaData);
    
   

    // Group the data by year
    const groupedData = d3.group(seAsiaData, d => d.umd_tree_cover_loss__year);
    console.log(groupedData);

        /*
        // Calculate the total tree cover loss for each year
        const totalLossByYear = Array.from(groupedData, ([year, data]) => ({ 
            year: year,
            //totalLoss: d3.sum(data.map(d => +d.umd_tree_cover_loss_ha))
            totalLoss: d3.sum(data.map(d => parseFloat(d.umd_tree_cover_loss_ha)))
            
        }));
        

   // Calculate the total tree cover loss for each year
    const totalLossByYear = Array.from(groupedData, ([year, data]) => {

    // Log the umd_tree_cover_loss_ha values before the conversion to numbers
    console.log('Before conversion:', data.map(d => d.umd_tree_cover_loss_ha));

 

    const totalLoss = d3.sum(data.map(d => {
        // Convert the umd_tree_cover_loss_ha values to numbers
        const loss = +d.umd_tree_cover_loss_ha;

    
         // If loss is NaN, return 0
    if (isNaN(loss)) {
        console.log(`umd_tree_cover_loss_ha is "${d.umd_tree_cover_loss_ha}" for year ${d.umd_tree_cover_loss__year}`);
        return 0;
    }


        // Log the umd_tree_cover_loss_ha values after the conversion to numbers
        console.log('After conversion:', loss);

        return loss;
    }));

    return {
        year: String(year),
        totalLoss: totalLoss
    };

});


    console.log(totalLossByYear);

    // Subtract the total tree cover loss in 2001 from the total tree cover loss in 2023 to get the net loss
    const lossIn2023 = totalLossByYear.find(d => d.year === '2023');
    const lossIn2001 = totalLossByYear.find(d => d.year === '2001');
    

    if (lossIn2023 && lossIn2001) {
        const netLoss = lossIn2023.totalLoss - lossIn2001.totalLoss;

        // Calculate the percentage of the net loss
        const netLossPercentage = (netLoss / lossIn2001.totalLoss) * 100;

        console.log(`Net loss from 2001 to 2023: ${netLoss}`);
        console.log(`Net loss percentage: ${netLossPercentage}%`);
    } else {
        console.log('Data for 2023 or 2001 is not available');
    }
    */


    //end of fetch treecover_loss_in_primary_forests_2001_tropics_only__ha.csv
    });

        //end of fetch world_forests.geoJson
    });

        
        </Script>


         <!-- Text -->
         <div id="Dv2_TropicalForests" class="w3-row w3-container">
             <!-- Text appeneds here -->
         </div> 


            <!--
            <div id="Dv2_TropicalForests_txtleft" style="display: flex; width: 500px; height: 200px; margin: 50px; text-justify: distribute-all-lines;">
             -->  
            
             <div id="Dv2_TropicalForests" class="w3-row">
                <div class="w3-col s6 w3-left">

                    <p id="body_txt"  style = "font-size: 25px;">In just over two decades between 2001 and 2023, the rate of annual deforestation rate has increased by 447 Kha in Southeast Asia.</p>
                    <br>
                    <br>
                    <p id="body_txt" style=" color: crimson; font-size: 50px;"><b>So why does this matter?</b></p>
                    <br>
                    <br>
              

                </div>   
            </div>
            <!-- 
            <div id="Dv2_TropicalForests_txtright" style="height: 200px; margin: 50px; text-align: right;">
                -->

            <div id="Dv2_TropicalForests" class="w3-row"> 
                <div class="w3-col s6 w3-right">

                    <p id="body_txt" class="w3-left" style = "font-size: 25px;">that is an increase in </p>
                    <br>
                    <p id="catch_txt" style=" color: rgb(2, 152, 10); font-size: 50px;"><b>3.5x yearly</b><br></p>
                    <br>
                    <p id="body_txt" class="w3-left" style = "font-size: 25px;"><em>Meaning within two decades we have lost over 35% of Cambodia's national area in deforestation</em></p>
                    
                </div>    
            </div>
   
      <!-- parent div: Map -->
    <div style="display: flex; justify-content: space-between;">
  
       <!-- child div --> 
        <div id="Dv2_TropicalForests_Map" style="width: 50%; height: 2000px; margin: 10px auto;">
            <!-- The SVG will be appended here -->
        </div>


        <script>
  
    let svg_dv2 = d3.select("#Dv2_TropicalForests_Map")
    .append("svg")
        //.attr("viewBox", "0 0 " + 1000 + " " + 1000)
        .attr("width", 3000)
        .attr("height", 2000)

    
    
        // Define the tooltip variable to select the tooltip element
     let tooltip = d3.select(".tooltip");

    
     // Tropical Forests Graph 

        // Load the data
        Promise.all([
            d3.json("https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/world_forest.geojson"),
            d3.csv("https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/The%20World%20Bank/goal15.forestemissions.csv")
        ]).then(function([geojson, csv]) {

            // Create a projection and path generator
            let projection = d3.geoMercator()
                //.center([103, 1])
                .scale(400)
                .translate([1500, 1500])
                //.fitExtent([[20, 20], [980, 580]], geojson);

          
            let geopath = d3.geoPath().projection(projection);

             // Draw the map
             svg_dv2.append("g")
                .attr("feature", "name")
                .selectAll("path")
                ///.data(geojson.features)
                .data(geojson.features.filter(d => d.properties.name !== 'Antarctica')) // Filter out Antarctica
                .enter()
                .append("path")
                .attr("d", geopath)
                .attr("fill", "#777")
                .attr("stroke", "#fff")
                .attr("stroke-width", 0.5);

        //Bubbles
            // Create a scale for the bubble size
            let sizeScale = d3.scaleSqrt()
                .domain(d3.extent(csv, row => +row.net))
                .range([1, 2]);

            // Bind the CSV data to circle elements
            svg_dv2.selectAll("circle")
                //.data(csv)
                .data(csv.filter(d => +d.net > 10)) // Filter out countries with net emissions less than 10
                .enter().append("circle")
                .attr("cx", d => projection([+d.x, +d.y])[0])
                .attr("cy", d => projection([+d.x, +d.y])[1])
                .attr("r", d => sizeScale(+d.net))
                .attr("fill", "red")
                .attr("opacity", 1.2)
               


        // Event handlers: update tooltip relative to mouse pointer
        //turning on the mouuse-over fucntion
        .on("mouseover", (event, d) => {
            const centroid = geopath.centroid(d);
            const [x, y] = centroid;
            

        d3.select(event.currentTarget)
        .classed("highlighted", true)
        //.attr("transform",`translate(${x * (1 - scale)}, ${y * (1- scale)}) scale(${scale}, ${scale})`)
        .raise(); // Raise section above projection


        //making the mouse-over function link to the tooltip
        //d3.select(".tooltip")
        tooltip.style("opacity", 1)
            .html(
            `<strong>Net Emissions: ${d.emissions.toLocaleString()} eCo2</strong>
            <br>
            Net Removals: ${d.removals.toLocaleString()} eCo2`)

            .style("display", "block")
            .style("left", event.pageX + 60 + "px")
            .style("top", event.pageY - 60 + "px");
            })
            .on("mouseout", (event, d) => {
                d3.select(event.currentTarget)
                .classed("highlighted", false)
                .attr("transform", "translate(0, 0) scale(1, 1)");

                d3.select(".tooltip").style("display", "none");

               
             });
        
    })// end data fetch
    /////////////////////////////////////////////end of script for Div 2


    </script> <!-- endchild div 1 -->

    <!-- child div -->

    <div id="EmissionMapText" style="Width: 100%; margin: 50px; text-align: left; color: white; font-size: 24px; margin-top: 100px;">
        <p>
            The decade between 2001 to 2021, this was the recorded net removals and net emissions stemming from tropical forests
            <br>
            <br>
            <b style = "color: green "> Amazon rainforest </b> = 1 Gt Emissions - 1.2 Gt Removals = <b>0.1 Gt C02e net removals</b>
            <br>
            <br>
            <b style = "color: green "> Congo Basin </b> = 0.53 GT Emissions - 1.1 GT removals = <b>0.61 GT CO2e net removals</b>
            <br>
            <br> 
            <b style="color: green;">Southeast Asia</b> = 1.6 GT Emissions - 1.1 GT removals = <b style="color: crimson;">0.49 Gt CO2e net emissions</b>


        </P> 

        </div> <!-- end child div 2 -->

    </div> <!-- end parent div -->

</body>

<div style="Width: 100%; margin: 50px; text-align: left; color: white; font-size: 24px; margin-top: 100px;">
    <p>
        There are only three congregations of tropical forests in the world: 
        <br>
        <br>
        <br>
        Amazon of South America -  DRC - Central Africa  And Southeast Asia
        <br>
        <br>
        <br>
        These tropical forests concetnrated around the equaror make up 45% of the worlds total forests. <b>These forests are the richest in biodiversity and store the largest amount of carbon.</b> The carbon density of tropical rain forests is twice as high as these in other regions.
        <br>
        <br>
        <br>
        <b>
            So SEA is hitting net emissions rather than removals, not only is it unpleasant and dangerous for the region, but it is problematic for our planetary ecosystem. 
        </b>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <b style="font-size: 50px; color: crimson;" class="w3-center">So why is deforestation happening in tropical regions?</b>




    </p>

</div>



<body>
      <!-- ------------------------------------ start of script for Div 3 -------------------------------------------- -->
      
   <!--
      <div id="div3_deforestCommodity" style="width: 100%;  display: flex; justify-content: space-around; margin-top: 300px;">
         <div id="div3_deforestCommodity" style="width: 100%;  display: flex;">
    -->

    <div id="div3_deforestCommodity" style="width: 100%;  display: flex; justify-content: space-around; margin-top: 300px;">
                                <!-- ------------- svg appends here -------------------------- -->
    </div>

    <script>

    // The Deforestation by commodity data
        // Defining SVG Size
        let svg = d3.select("#div3_deforestCommodity").append("svg")
            //.attr("viewBox", [-width / 2, -height / 2, width, height])
            //.viewBox="-500,-300,1000,600"

            .attr("height", 1000, "width", 1000)
            .viewBox="0,0,2000,600"

            //.attr("width", 900)
            //.attr("height", 1400);

        // Load the data
            d3.csv("https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/The%20World%20Bank/goal15.drivers_cover_loss.csv").then(data => {
            // Filter the data to include only the regions you're interested in
            const regions = ["LCN", "SSF", "SAS"];
            data = data.filter(d => regions.includes(d.region));

            // Group the data by region and sum the shares for each driver
            const dataByRegion = d3.group(data, d => d.region);
            //const dataByRegion = d.region

            // Create a pie generator
            const pie = d3.pie()
                .value(d => d.share);

            // Create an arc generator
            const arc = d3.arc()
                .innerRadius(50)
                //.innerRadius(0)

                //.outerRadius(Math.min(width, height) / 5 - 55);
                //.outerRadius(Math.min(1000, 1000) / 5 - 55);
                .outerRadius(Math.min(1000, 1000) / 5 - 55);

                //.outerRadius(Math.min(1000, 1000) /2);
                //.outerRadius(200);

            

            // Create a color scale
            const color = d3.scaleOrdinal()
                .domain(data.map(d => d.driver))
                .range(d3.quantize(t => d3.interpolateSpectral(t * 0.8 + 0.1), data.length).reverse());
            
            
            /*
            // Define the color scale
            const color = d3.scaleSequential()
                .domain(data.map(d => d.driver))
                .interpolator(d3.interpolateRainbow); // Use a different color interpolator
            
            */

            // For each region, bind the data to path elements and set their attribute using the arc generator
            dataByRegion.forEach((value, key) => {
                const svg = d3.select("#div3_deforestCommodity").append("svg")
                    //.attr("viewBox", [-width / 2, -height / 2, width, height])
                    .attr("height", 1000, "width", 1000);

                svg.append("g")
                    .attr("stroke", "white")
                    .selectAll("path")
                    .data(pie(value))
                    .join("path")
                    .attr("fill", d => color(d.data.driver))
                    .attr("d", arc)
                    .append("title")
                    .text(d => `${d.data.driver}: ${d.data.share.toLocaleString()}`)
                    //.style("font-size", "24px")
                    //.style("font-color", "white");
           

            var key = data.map(d =>d.region);

           // Add a title above each pie chart
            svg.append("text")
                .attr("x", width / 2)
                .attr("y", 20)
                .attr("text-anchor", "middle")
                .style("font-size", "50px")
                .style("text-decoration", "underline")
                .style("font-color", "white")
                .text(key);

            svg.append("g")
                .attr("stroke", "white")
                .selectAll("path")
                .data(pie(value))
                .join("path")
                .attr("fill", d => color(d.data.driver))
                .attr("d", arc)
                .append("title")
                .text(d => `${d.data.driver}: ${d.data.share.toLocaleString()}`)
                //.style("font-size", "24px")
                //.style("font-color", "white")  
                console.log(data.driver)
                console.log(data.share)

        }); 

        // Add a legend
            const legend = d3.select("#div3_deforestCommodity").append("div")
                .attr("class", "legend")
                .style("margin-top", "20px")
                .style("color", "white")
                .style("font-size", "24px")

            legend.selectAll("div")
                .data(color.domain())
                .enter().append("div")
                .style("display", "flex")
                .style("align-items", "center")
                .style("margin-bottom", "10px")
                .html(d => `<div style="width: 20px; height: 20px; background-color: ${color(d)}; margin-right: 10px;"></div> ${d}`);
        
        
            });
  /////////////////////////////////////////////end of script for Div 3
</script>

<!-- <iframe src="https://ourworldindata.org/grapher/human-development-index?tab=chart&region=Asia&facet=none&country=KHM~SGP~THA~MMR~MYS~LAO~VNM~IDN~PHL~TLS~Very+high+human+development+%28UNDP%29" loading="lazy" style="width: 100%; height: 600px; border: 0px none;"></iframe>-->


<!-- ------------------------------------ start of script for Div 4:HmanDev -------------------------------------------- -->
   
<!-- parent div -->
<div style="display: flex; justify-content: space-between;">

    <!-- child div -->
        <div id="div4_HumanDev_Graph" style="width: 50%; margin: 100px; height: 400px; display: flex; justify-content: right; margin-top: 50px;">
        
            <!-- ------------- Human Development Data: Embedd of https://ourworldindata.org/human-development-index  -------------------------- -->
            <iframe src="https://ourworldindata.org/grapher/human-development-index?tab=chart&region=Asia&facet=none&country=KHM~SGP~THA~MMR~MYS~LAO~VNM~IDN~PHL~TLS~Very+high+human+development+%28UNDP%29" loading="lazy" style="width: 100%; height: 600px; border: 0px none;"></iframe>
            <div style="background: rgba(128, 4, 4, 0.5); position: absolute; top: 0; left: 0; width: 60%; margin: 50px;"></div>

        </div>

    <!-- child div -->
        <div id="div4_HumanDev_Text" style="Width: 50%; height: 200px; margin: 50px; text-align: left;">
            <p id="body_txt">So why keep going? Why not do a hard pause on all industries devepending on deforesetation?
                <br>
                Well because it's not that simple. Deforestation in the region has contributed to
            </p>
            <br>
            <br>
            <p id="catch_txt">Development and economic Growth</p>
            <br>
            <br>
            <p id="body_txt">To understadn thism lets look at the <strong>The Human Development Index (HDI).</strong><br>
                HDI is a summary measure of average achievement in key dimensions of human development:
                a long and healthy life, being knowledgeable and have a decent standard of living. The HDI is the geometric mean of normalized 
                indices for each of the three dimensions.</p>
        </div>
</div>

<!-- ------------------------------------ end of script for Div 4:HmanDev -------------------------------------------- -->


<!-- ------------------------------------ start of script for Div 5:Sea_FrstandDev -------------------------------------------- -->
   
  
        <div id="Div5_Sea_FrstandDev" style="width: 80%; display: grid; grid-template-columns: repeat(4, 1fr); grid-gap: 20px; justify-content: space-around; margin:50px; margin-top: 300px; margin-bottom: 30px;">
        <!-- -------------------------------------- svgDv5 appends here -------------------------- -->
             </div>

             <p id="value"></p>

         
             <div id="slider">
                <!-- appends slider here -->
             </div>
         

                   <!-- ----------------- Commence script: Countries SVG to change colours refelctive of tree loss by respective years  ------------------- -->
             <script>
             
             
                 let forestLossData
                     d3.csv("https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/global%20tree%20watch/Global%20annual%20tree%20cover%20loss%20by%20dominant%20driver/treecover_loss_in_primary_forests_2001_tropics_only__ha.csv")
                         .then(data => {
                             forestLossData = data.map(d => ({
                                 iso: d.iso,
                                 year_f: d.umd_tree_cover_loss__year,
                                 treeloss: +d.umd_tree_cover_loss__ha,
                             }));
                 
                     // Process the data
                     const forestLossByCountryAndYear = d3.group(forestLossData, d => d.iso, d => d.year_f, d => d.treeloss);
             
                    /* const forestLossByCountryAndYear = d3.rollup(forestLossData, 
                         v => d3.sum(v, leaf => leaf.treeloss),  // Sum the tree loss values for each group
                         d => d.iso,  // Group by country
                         d => d.year_f  // Then by year
                     );
                     */
                     
                     // Create color scale for forest density
                     const forestLossValues = data.map(d => d.treeloss);
                     const colorScale = d3.scaleSequential(d3.interpolateGreens)
                         .domain(d3.extent(forestLossValues));
                 
                     //create container for button
                     const container = d3.select("#Div5_Sea_FrstandDev");
                 
                     fetch('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/world_forest.geojson')
                         .then(response => response.json())
                         .then(MapDataDv5 => {
                             // Filter to include only Southeast Asian countries
                             const countryDv5 = MapDataDv5.features.filter(function(d) {   
                                 return ["IDN", "MYS", "PHL", "THA", "BRN", "VNM", "LAO", "MMR", "KHM", "TLS", "SGP"]
                                             .includes(d.properties.id);
                             });
             
                             /*
             
                                 // function to update the SVGs
                                 function updateSVGs(year) {
                                     d3.selectAll("svg").selectAll("path")
                                         .attr("fill", d => {
                                             const forestDensity = forestDensityByCountryAndYear.get(country.properties.id)?.get(year);
                                             return colorScale(forestDensity);
                                         });
                                 }
                             */
             
                             // function to update the SVGs
             
                                 function updateSVGs(year) {

                                     d3.select("#Div5_Sea_FrstandDev").selectAll("svg").each(function() {
                                     const svg = d3.select(this);
             
                                 const countryId = svg.attr("id")?.replace(/_/g, " ");
                                     svg.selectAll("path")
                                         .attr("fill", d => {
                                                 //const forestLossData = forestLossByCountryAndYear.get(d.iso)?.get(d.umd_tree_cover_loss__year).get(d.umd_tree_cover_loss__ha);
                                                 //const forestDensity = forestLossByCountryAndYear.get(countryId)?.get(year);
                                             
                                                 //return colorScale(forestDensity);
             
                                                 //const forestLoss = forestLossByCountryAndYear.get(countryId)?.get(year);
                                                 //return colorScale(forestLoss);
             
                                                 //const forestLoss = forestLossByCountryAndYear.get(countryId)?.treeloss;
                                                 const forestLoss = forestLossByCountryAndYear.get(countryId)?.get(year)?.get("treeloss"); //getting treeloss form the third nest - just cant figure out what format it wants..(??????)

                                                 return forestLoss !== undefined ? colorScale(forestLoss) : "white";  // Default color if undefined
                                                 return colorScale(forestLoss); 
             
             
                                             });
                                     });
                                 }
                 
                             // Create a SVG for each country
                             countryDv5.forEach((country, i) => {
                                 const svg = container.append("svg")
                                     .attr("width", 200)
                                     .attr("height", 200)
                                     .attr("fill", "gray")
                                     .attr("id", country.properties.id.replace(/\s/g, "_"))  // Assign an id to the SVG
                                     .style("grid-column", (i % 4) + 1)
                                     .style("grid-row", Math.floor(i / 4) + 1);
                 
                                 // Create a projection that fits the country within the SVG
                                 const projection = d3.geoMercator().fitSize([200, 200], country);
                                 const path = d3.geoPath().projection(projection);
                 
                                 svg.append("path")
                                     .attr("d", path(country))
                                     
                                     .attr("fill", d => {
                                         const forestLoss = forestLossByCountryAndYear.get(country.properties.id)?.get('2000');
                                         return colorScale(forestLoss);
                                         return forestLoss === undefined ? "white" : colorScale(forestLoss);
                                     })
                                     //.attr("stroke", "white")
                                     //.attr("stroke-width", 0.5)
                                     .attr("opacity", 0.8);
             
                        
                                 
                 
                                 // Append country name as a label under the SVG
                                 container.append("div")
                                     .text(country.properties.name)
                                     .style("grid-column", (i % 4) + 1)
                                     .style("grid-row", Math.floor(i / 4) + 1)
                                     .style("text-align", "center")
                                     .style("font-size", "15px")
                                     .style("color", "white")
                                     .style("font-family", "Poppins");
             
                             });
                 
                               // Create a slider
                                     //var slider = d3
                                     var slider = d3
                                         .sliderHorizontal()
                                         .min(2000)
                                         .max(2020)
                                         .step(1)
                                         .width(1000)
                                         .tickFormat(d3.format(""))  // Format the ticks as integers	
                                         .displayValue(false)
                                         .on('onchange', (val) => {
                                         updateSVGs(String(Math.round(val)));
                                         d3.select('#value').text(val);
                                         });
                                   
                 
                                     d3.select('#slider')
                                         .append('svg')
                                         .attr('width', 1500)
                                         .attr('height', 100)
                                         .append('g')
                                         .attr('transform', 'translate(30,30)')
                                         .call(slider);
                                  
                 
                                 console.log("slider", updateSVGs);
                                  console.log(forestLossData);     
                                  
                             
                         });
                     }); 
                 
                 </script>

   

<script>
    /*
        // Defining SVG Size
        let svgDv4 = d3.select("#Div5_Sea_FrstandDev").append("svg")
            .attr("viewBox", [-width / 2, -height / 2, width, height]);
            //.attr("width", 900)
            //.attr("height", 1400);

        // Load the data
            d3.csv("https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/The%20World%20Bank/goal15.drivers_cover_loss.csv").then(data => {
            // Filter the data to include only the regions you're interested in
            const regions = ["LCN", "SSF", "SAS"];
            data = data.filter(d => regions.includes(d.region));

            // Group the data by region and sum the shares for each driver
            const dataByRegion = d3.group(data, d => d.region);

            // Create a pie generator
            const pie = d3.pie()
                .value(d => d.share);

            // Create an arc generator
            const arc = d3.arc()
                .innerRadius(50)
                .outerRadius(Math.min(width, height) / 5 - 55);

            

            // Create a color scale
            const color = d3.scaleOrdinal()
                .domain(data.map(d => d.driver))
                .range(d3.quantize(t => d3.interpolateSpectral(t * 0.8 + 0.1), data.length).reverse());
            
            
            /*
            // Define the color scale
            const color = d3.scaleSequential()
                .domain(data.map(d => d.driver))
                .interpolator(d3.interpolateRainbow); // Use a different color interpolator
            
        

            // For each region, bind the data to path elements and set their attribute using the arc generator
            dataByRegion.forEach((value, key) => {
                const svg = d3.select("#Div5_Sea_FrstandDev").append("svg")
                    .attr("viewBox", [-width / 2, -height / 2, width, height]);

                svg.append("g")
                    .attr("stroke", "white")
                    .selectAll("path")
                    .data(pie(value))
                    .join("path")
                    .attr("fill", d => color(d.data.driver));
        
            });
            */

/* // Load the forest density and HDI data

        Promise.all([
            d3.csv('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/global%20tree%20watch/Global%20annual%20tree%20cover%20loss%20by%20dominant%20driver/treecover_loss_in_primary_forests_2001_tropics_only__ha.csv'),
            d3.csv('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/Our%20Wolrd%20Data_HUman%20Index/human-development-index.csv')
        ]).then(([forestData, hdiData]) => {
            
            // Process the data
            const forestDensityByCountryAndYear = d3.group(forestData, d => d.iso, d => d.umd_tree_cover_loss__year);
            const hdiByCountryAndYear = d3.group(hdiData, d => d.Entity, d => d.Year);

            // Create color scale for forest density
            const forestDensityValues = forestData.map(d => +d.umd_tree_cover_loss__ha);
            const colorScale = d3.scaleSequential(d3.interpolateGreens)
                .domain(d3.extent(forestDensityValues));

            //create container for button
            const container = d3.select("#Div5_Sea_FrstandDev");

            fetch('https://raw.githubusercontent.com/sarahtuke/HASS-assignment-5.2/main/data%20src/world_forest.geojson')
                .then(response => response.json())
                .then(MapDataDv5 => {

                    // Filter to include only Southeast Asian countries
                    const countryDv5 = MapDataDv5.features.filter(function(d) {   
                       return ["IDN", "MYS", "PHL", "THA", "BRN", "VNM", "LAO", "MMR", "KHM", "TLS", "SGP"]
                                .includes(d.properties.id);

                            });
                    //console.log('Countries recognised:',d.properties.name);
                    //console.log('Countries recognised:', MapDataDv5);
                    //console.log('Countries recognised:', countryDv5);
                    //console.log('Forest Data recognised:', forestData); 
                    //console.log('Forest density by year recognised:', forestDensityByCountryAndYear);//returning undefined
                    console.log('HDI Data recognised:', hdiData);
                    //console.log('Forest density by year recognised:', hdiByCountryAndYear);
                    console.log('hdiByCountryAndYear recognised:', hdiByCountryAndYear );
                    
                       
                   
                
               



                    // Create a SVG for each country

                    countryDv5.forEach((country, i) => {
                        const svg = container.append("svg")
                            .attr("width", 200)
                            .attr("height", 200)
                            .attr("id", country.properties.id.replace(/\s/g, "_"))  // Assign an id to the SVG
                            .style("grid-column", (i % 4) + 1)
                            .style("grid-row", Math.floor(i / 4) + 1);

                            console.log('Country ID:', country.properties.id); 


                    // Create a projection that fits the country within the SVG
                    const projection = d3.geoMercator().fitSize([200, 200], country);
                    const path = d3.geoPath().projection(projection);

                    svg.append("path")
                        .attr("d", path(country))
                        .attr("fill", d => {
                            console.log('Country:', country.properties.name);  // Add this line
                            //console.log('Forest density map:', forestDensityByCountryAndYear);  // Add this line

                            const forestDensity = forestDensityByCountryAndYear.get(country.properties.id)?.get('2000');
                            return colorScale(forestDensity);
                        })
                        .attr("stroke", "black")
                        .attr("stroke-width", 0.5)
                        .attr("opacity", 0.8)
                        .on("mouseover", function() {
                            //console.log('Country:', country.properties.name);  // Add this line
                            //console.log('HDI map:', hdiByCountryAndYear);  // Add this line

                            const hdi = hdiByCountryAndYear.get(country.properties.name)?.get('2000');
                            d3.select(this).append("title").text(`HDI: ${hdi}`);
                        });

                    // Append country name as a label under the SVG
                    container.append("div")
                        .text(country.properties.name)
                        .style("grid-column", (i % 4) + 1)
                        .style("grid-row", Math.floor(i / 4) + 1)
                        .style("text-align", "center")
                        .style("font-size", "10px")
                        .style("color", "white");

                    // Append an element for the HDI text
                    svg.append("text")
                        .attr("class", "hdi-text")
                        .attr("x", 100)  // Adjust the x and y coordinates as needed
                        .attr("y", 100);

                    }); // Add this closing brace

                
                
                    // Function to update the HDI text and forest density color
                    function updateHDI(year) {
                        countryDv5.forEach(country => {
                            const hdi = hdiByCountryAndYear.get(country.properties.name)?.get(year);
                            const forestDensity = forestDensityByCountryAndYear.get(country.properties.id)?.get('2000') || 0;
                            const svg = d3.select(`#${country.properties.id.replace(/\s/g, "_")}`);
                            svg.select(".hdi-text").text(`HDI: ${hdi}`);
                            svg.select("path").attr("fill", colorScale(forestDensity));
                        });
                    }

                    // Create a scale for the timeline
                    //const years = hdiData.map(d => d.Year);
                    const timelineScale = d3.scaleLinear()
                        .domain(2000, 2020)  // Adjust the domain to match the years in your data
                        .range([0, 200]);  // Adjust the range to match the width of your timeline


                 const playButton = container.append("button");
                     playButton.text("Play");

                    // Start the transition when the play button is clicked
                    playButton.node().addEventListener("click", () => {
                        d3.selectAll("svg")
                            .transition()
                            .duration(10000)  // Adjust the duration as needed
                            .ease(d3.easeLinear)
                            .tween("year", () => {
                                //const yearInterpolator = d3.interpolateRound(d3.min(years), d3.max(years));
                                const yearInterpolator = d3.interpolateRound(2000, 2020);
                                return t => updateHDI(String(yearInterpolator(t)));
                            });
                    });
                });

                //end of promise.all
            });    
 */
</script>                         

<!-- ------------------------------------ end of script for Div 5:Sea_FrstandDev -------------------------------------------- -->
                        <div>
                            <h2>References</h2>
                        </div>
        </body>
</html>